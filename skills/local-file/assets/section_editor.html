<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><<SECTION_LABEL>> — <<ENTITY_NAME>></title>
  <!-- BRAND_CSS_INJECT -->
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--sn-font, system-ui, sans-serif);
      background: var(--sn-bg, #020612);
      color: var(--sn-text, #e2e8f0);
      line-height: 1.5;
      padding: 0;
    }

    /* --- Top bar --- */
    .top-bar {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 20px;
      background: var(--sn-surface, #111827);
      border-bottom: 1px solid var(--sn-border, #1e293b);
      position: sticky; top: 0; z-index: 10;
    }
    .top-bar-left { display: flex; align-items: center; gap: 12px; }
    .top-bar-title { font-weight: 600; font-size: 15px; }
    .top-bar-subtitle { font-size: 13px; color: var(--sn-text-muted, #94a3b8); }
    .breadcrumb { font-size: 12px; color: var(--sn-text-dim, #64748b); }
    .breadcrumb .active { color: var(--sn-primary, #0a6afc); font-weight: 500; }

    .top-bar-right { display: flex; align-items: center; gap: 12px; }
    .theme-toggle {
      background: none; border: 1px solid var(--sn-border); border-radius: var(--sn-radius-sm, 4px);
      color: var(--sn-text-muted); padding: 4px 8px; cursor: pointer; font-size: 12px;
    }
    .theme-toggle:hover { border-color: var(--sn-text-muted); }

    /* --- Section header --- */
    .section-header {
      padding: 20px;
      border-bottom: 1px solid var(--sn-border);
    }
    .section-category {
      font-size: 11px; font-weight: 600; text-transform: uppercase;
      letter-spacing: 0.05em; color: var(--sn-text-dim);
      margin-bottom: 4px;
    }
    .section-title { font-size: 18px; font-weight: 600; }
    .section-meta-row {
      display: flex; align-items: center; gap: 12px;
      margin-top: 8px;
    }

    .layer-badge {
      display: inline-flex; align-items: center; gap: 6px;
      font-size: 11px; font-weight: 500; padding: 3px 8px;
      border-radius: var(--sn-radius-sm, 4px);
      border: 1px solid;
    }
    .layer-badge .dot { width: 6px; height: 6px; border-radius: 50%; }

    .source-path {
      font-size: 11px; color: var(--sn-text-dim);
      font-family: var(--sn-font-mono, monospace);
    }

    .section-note {
      margin-top: 8px; padding: 8px 12px;
      background: var(--sn-warning-dim, rgba(245,158,11,0.08));
      border-left: 3px solid var(--sn-warning, #f59e0b);
      border-radius: 0 var(--sn-radius-sm) var(--sn-radius-sm) 0;
      font-size: 12px; color: var(--sn-text-muted);
    }

    /* --- Content area --- */
    .content-area { padding: 20px; }

    .edit-area {
      width: 100%; min-height: 200px; padding: 16px;
      font-family: var(--sn-font-serif, Georgia, serif);
      font-size: 14px; line-height: 1.7;
      color: var(--sn-text);
      background: var(--sn-surface);
      border: 1px solid var(--sn-border);
      border-radius: var(--sn-radius, 6px);
      resize: vertical;
      transition: border-color 0.15s;
    }
    .edit-area:focus {
      outline: none;
      border-color: var(--sn-primary);
    }
    .edit-area::placeholder { color: var(--sn-text-dim); }

    /* Auto-generated table display */
    .auto-table-container {
      background: var(--sn-surface);
      border: 1px solid var(--sn-border);
      border-radius: var(--sn-radius);
      overflow-x: auto;
    }
    .auto-table {
      width: 100%; border-collapse: collapse; font-size: 13px;
    }
    .auto-table th {
      text-align: left; padding: 10px 12px;
      background: var(--sn-bg);
      border-bottom: 1px solid var(--sn-border);
      font-weight: 600; font-size: 11px;
      text-transform: uppercase; letter-spacing: 0.04em;
      color: var(--sn-text-muted);
    }
    .auto-table td {
      padding: 10px 12px;
      border-bottom: 1px solid var(--sn-border);
    }
    .auto-table tr:last-child td { border-bottom: none; }
    .auto-label {
      display: inline-block; font-size: 11px; font-weight: 500;
      color: var(--sn-primary); padding: 2px 6px;
      background: rgba(10,106,252,0.1);
      border-radius: var(--sn-radius-sm);
      margin-bottom: 12px;
    }

    /* --- Action bar --- */
    .action-bar {
      padding: 16px 20px;
      border-top: 1px solid var(--sn-border);
      display: flex; align-items: center; gap: 12px;
      position: sticky; bottom: 0;
      background: var(--sn-surface);
    }
    .btn {
      padding: 8px 16px; border-radius: var(--sn-radius, 6px);
      font-size: 13px; font-weight: 500; cursor: pointer;
      border: 1px solid var(--sn-border);
      background: var(--sn-surface); color: var(--sn-text);
      transition: background 0.15s, border-color 0.15s;
    }
    .btn:hover { background: var(--sn-surface-hover, #1e293b); }
    .btn-primary {
      background: var(--sn-primary); color: #fff;
      border-color: var(--sn-primary);
    }
    .btn-primary:hover { background: var(--sn-primary-hover, #0856cc); }
    .copy-status { font-size: 12px; color: var(--sn-success); display: none; }

    /* --- Light theme --- */
    [data-theme="light"] {
      --sn-bg: #f8fafc;
      --sn-surface: #ffffff;
      --sn-border: #e2e8f0;
      --sn-text: #0f172a;
      --sn-text-muted: #64748b;
      --sn-text-dim: #94a3b8;
      --sn-surface-hover: #f1f5f9;
    }
  </style>
</head>
<body data-theme="dark" data-section-key="<<SECTION_KEY>>" data-entity-id="<<ENTITY_ID>>">

  <!-- Top bar -->
  <div class="top-bar">
    <div class="top-bar-left">
      <div>
        <div class="top-bar-title"><<ENTITY_NAME>></div>
        <div class="top-bar-subtitle">Local File — FY <<FISCAL_YEAR>></div>
      </div>
    </div>
    <div class="top-bar-right">
      <span class="breadcrumb">Overview › <span class="active">Editor</span> › Report view › Final PDF</span>
      <button class="theme-toggle" onclick="toggleTheme()">◑</button>
    </div>
  </div>

  <!-- Section header -->
  <div class="section-header">
    <div class="section-category"><<SECTION_CATEGORY>></div>
    <div class="section-title"><<SECTION_LABEL>></div>
    <div class="section-meta-row">
      <<LAYER_BADGE>>
      <<SOURCE_PATH>>
    </div>
    <<SECTION_NOTE>>
  </div>

  <!-- Content -->
  <div class="content-area">
    <<SECTION_CONTENT>>
  </div>

  <!-- Action bar (only for content sections, not auto) -->
  <<ACTION_BAR>>

  <script>
    function toggleTheme() {
      const body = document.body;
      body.dataset.theme = body.dataset.theme === 'dark' ? 'light' : 'dark';
    }

    function sendUpdates() {
      const key = document.body.dataset.sectionKey;
      const entityId = document.body.dataset.entityId;
      const textarea = document.querySelector('.edit-area');
      if (!textarea) return;

      const original = textarea.dataset.original || '';
      const current = textarea.value;

      if (current === original) {
        document.querySelector('.copy-status').textContent = 'No changes to send';
        document.querySelector('.copy-status').style.display = 'inline';
        setTimeout(() => { document.querySelector('.copy-status').style.display = 'none'; }, 2000);
        return;
      }

      const payload = {
        _source: 'section_edit',
        _entity_id: entityId,
        _section_key: key,
        _summary: ['Updated: <<SECTION_LABEL>>'],
        sections: {}
      };
      payload.sections[key] = current;

      navigator.clipboard.writeText(JSON.stringify(payload, null, 2)).then(() => {
        document.querySelector('.copy-status').textContent = 'Copied — paste in chat';
        document.querySelector('.copy-status').style.display = 'inline';
        setTimeout(() => { document.querySelector('.copy-status').style.display = 'none'; }, 3000);
      });
    }
  </script>

</body>
</html>
